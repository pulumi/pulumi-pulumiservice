name: yaml-deployment-schedule
runtime: yaml
description: Example of DeploymentSchedule resource

config:
  organizationName:
    type: string
    default: service-provider-test-org
  digits:
    type: string

resources:
  # DeploymentSettings required before schedule
  settings:
    type: pulumiservice:DeploymentSettings
    properties:
      organization: ${organizationName}
      project: yaml-deployment-schedule
      stack: test-stack-${digits}
      sourceContext:
        git:
          repoUrl: https://github.com/pulumi/examples.git
          branch: refs/heads/master

  # Deployment schedule
  schedule:
    type: pulumiservice:DeploymentSchedule
    properties:
      organization: ${organizationName}
      project: yaml-deployment-schedule
      stack: test-stack-${digits}
      scheduleCron: "0 0 1 1 *"
      pulumiOperation: update
    options:
      dependsOn:
        - ${settings}

outputs:
  scheduleId: ${schedule.scheduleId}
